{% extends "webclient/scripts/base_custom_dialog.html" %}
{% load i18n %}

{% comment %}
<!--
  Copyright (C) 2011 University of Dundee & Open Microscopy Environment.
  All rights reserved.

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as
  published by the Free Software Foundation, either version 3 of the
  License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
{% endcomment %}

{% comment %}
<!--
    This page displays a UI for Split View Figure
-->
{% endcomment %}

{% block title %}
    Create Thumbnail Figure
{% endblock %}



{% block script %}
    {{ block.super }}
    <script type="text/javascript" src="{% static "webclient/javascript/ome.thumbnail_figure.js" %}"></script>
    <link rel="stylesheet" href="{% static '3rdparty/jquery.chosen/chosen.css' %}" type="text/css" media="screen"/>
    <script type="text/javascript" src="{% static '3rdparty/jquery.chosen/chosen.jquery.js' %}"></script>
{% endblock %}


{% block content %}


<div id="script_content">

<form id="script_form" method="post" action="{% url script_run scriptId %}">

    <div style="margin-left:auto; margin-right:auto; width:500px">
    {% block script_form %}

        <h1>Create Thumbnail Figure</h1>

        <hr/>

        <!-- Data_Type and IDs are already set (we can hide these) -->
        <select name="Data_Type" style="display:none">
            <option value="Dataset"  >Dataset</option>
            <option value="Image"  selected="True"  >Image</option>
        </select>
        <input type="text" name="IDs" value="{{ idString }}" style="display:none">

        <span title="File name of the figure to save.">
            Figure Name:
            <input type="text" name="Figure_Name"  value="Thumbnail_Figure"  />
        </span>

        <span title="Format to save image">
            Format:
            <select name="Format">
                <option value="JPEG"  selected="True"  >JPEG</option>
                <option value="PNG"  >PNG</option>
                <option value="TIFF"  >TIFF</option>
            </select>
        </span>

        <hr/>

        <!-- Thumbnail size - we provide a dropdown selection (hide the number field) -->
        <span>
            Thumbnail size:
            <!--<input type="text" name="Thumbnail_Size" class="number" value="96" style="display:none"/>-->
            <select name="Thumbnail_Size">
                <option value="24">24x24</option>
                <option value="32">32x32</option>
                <option value="48">48x48</option>
                <option value="64">64x64</option>
                <option value="96" selected>96x96</option>
                <option value="128">128x128</option>
                <option value="160">160x160</option>
            </select>
        </span>

        <span>
            Images per row:
            <input type="text" name="Max_Columns" class="number" size="3" value="10"  />
        </span>

        <hr/>

        <!-- Allow user to pick Tags for filtering -->
        <span title="Sort thumbnails by Tags">
            Select by tag:
            <input type="checkbox" name="Select_by_tag" />
        </span>
        <br>
        <span title="Include images that have none of the chosen tags">
            Include all thumbnails:
            <input type="checkbox" name="Show_Untagged_Images"  />
        </span>

        <!-- <input type="text" name="Tag_IDs" style="display:none"/> -->

        <select name="Tag_IDs" multiple="multiple">
            {% for t in tags %}
                <option value="{{ t.id }}">{{ t.getTextValue }}</option>
            {% endfor %}
        </select>

        <!-- TODO: Do we do anything with this? -->
        <input type="text" name="Parent_ID" class="number"  style="display:none"/>
        <hr>



    {% endblock %}
    </div>

    <div class="footer">
        <div style="float:right">
            <a href="#" onClick="self.close()">Cancel</a>
            <input id="submit" type="submit" value="Create Figure" />
        </div>
        <a href="#" onClick="return openPopup('{% url get_original_file scriptId %}');">View Script</a>

        <div id="img_size_slider" title="Zoom Preview Figure"></div>
    </div>

</form>


<!---------------------------- FIGURE PREVIEW ---------------------->

<table id="figure_table">
    <tr><td>
        <div style="padding:10px">

    {% block figure_preview %}
    <table>
    <tr>
        <td> FIGURE HERE </td>
    </tr>
    </table>
    {% endblock %}

</div>
</td></tr>
</table>

</div>
{% endblock %}
