{% load i18n %}
{% load markup %}
{% load custom_tags %}

<!--

  Copyright (C) 2011 University of Dundee & Open Microscopy Environment.
  All rights reserved.

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as
  published by the Free Software Foundation, either version 3 of the
  License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->

<script>

    $(document).ready(function(){

        $("#metadata").accordion( { 
            autoHeight: false,
            active: false,
            alwaysOpen: false, 
            navigation: true
        });
                    
    });
</script>

<div>
<ul id="metadata" class="ui-accordion-metadata" >
    <li><a href='#'>{% trans "Image details" %}:</a>
        <div class="metadata_details">
            <table class="forms">
                <tr><td><label>{% trans "Image name" %} </label></td><td>{{ manager.well.selectedWellSample.image.name }}</td></tr>
                <tr><td><label>{% trans "Image date" %} </label></td><td>{{ manager.well.selectedWellSample.image.getDate|date:"Y-m-d H:i:s" }}</td></tr>
                <tr><td><label>{% trans "Dimensions" %} (XY) [px] </label></td><td>{{ manager.well.selectedWellSample.image.getSizeX }} x {{ manager.well.selectedWellSample.image.getSizeY }}</td></tr>
                <tr><td><label>{% trans "Pixel size" %} (XYZ) [&micro;m] </label></td><td>{{ manager.well.selectedWellSample.image.getPixelSizeX|default_if_none:"-" }} x {{ manager.well.selectedWellSample.image.getPixelSizeY|default_if_none:"-" }} x {{ manager.well.selectedWellSample.image.getPixelSizeZ|default_if_none:"-" }}</td></tr>
                <tr><td><label>{% trans "Z-sections" %} </label></td><td>{{ manager.well.selectedWellSample.image.getSizeZ }}</td></tr>
                <tr><td><label>{% trans "Timepoints" %} </label></td><td>{{ manager.well.selectedWellSample.image.getSizeT }}</td></tr>
            </table>
        </div>
    </li>
    {% if manager.global_metadata %}
    <li><a href='#'>{% trans "Global metadata" %}:</a>
        <div><div class="metadata_details"><input type="button" value="Download" onClick="document.location.href='{% url download_annotation "download" manager.original_metadata.id %}';"/>
            <table class="formsm">
            {% for gm in manager.global_metadata %}
                <tr><td><label>{{ gm.0 }}</label></td><td>{{ gm.1 }}</td></tr>
            {% endfor %}
            </table>
        </div></div>
    </li>
    {% endif %}
    {% if manager.series_metadata %}
    <li><a href='#'>{% trans "Series metadata" %}:</a>
        <div><div class="metadata_details"><input type="button" value="Download" onClick="document.location.href='{% url download_annotation "download" manager.original_metadata.id %}';"/>
            <table class="formsm">
            {% for sm in manager.series_metadata %}
                <tr><td><label>{{ sm.0 }}</label></td><td>{{ sm.1 }}</td></tr>
            {% endfor %}
            </table>
        </div></div>
    </li>
    {% endif %}
    {% if form_objective or form_environment or form_stageLabel %}
    <li><a href='#'>{% trans "Image" %}:</a>
        <div><div class="metadata_details">
            <table class="forms">
            {% if form_objective %}
            <tr><th>{% trans "Objective" %}:</th><td colspan="2"></td></tr>
                {% for field in form_objective %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                <tr><th><br/></th><td colspan="2"></td></tr>
            {% endif %}
            {% if form_environment %}
            <tr><th>{% trans "Environment" %}:</th><td colspan="2"></td></tr>
                {% for field in form_environment %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                <tr><th><br/></th><td colspan="2"></td></tr>
            {% endif %}
            {% if form_stageLabel %}
            <tr><th>{% trans "Stage label" %}:</th><td colspan="2"></td></tr>
                {% for field in form_stageLabel %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                <tr><th><br/></th><td colspan="2"></td></tr>
            {% endif %}
            </table>
        </div></div>
    </li>
    {% endif %}
    {% if form_objective or form_filters or form_detectors %}
    <li><a href='#'>{% trans "Microscope" %}:</a>
        <div><div class="metadata_details">
            <table class="forms">
            {% if form_objective %}
            <tr><th>{% trans "Objective" %}:</th><td colspan="2"></td></tr>
                {% for field in form_objective %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
            <tr><th><br/></th><td colspan="2"></td></tr>
            {% endif %}
            {% for form in form_filters %}
                <tr><th>{% trans "Filter" %}:</th><td colspan="2"></td></tr>
                {% for field in form %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
            <tr><th><br/></th><td colspan="2"></td></tr>
            {% endfor %}
            {% for form in form_detectors %}
                <tr><th>{% trans "Detector" %}:</th><td colspan="2"></td></tr>
                {% for field in form %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
            <tr><th><br/></th><td colspan="2"></td></tr>
            {% endfor %}
            </table>
        </div></div>
    </li>
    {% endif %}
    {% for ch in form_channels %}
    <li><a href='#'>{% trans "Channel" %} : <span style="padding:0 3px; color:#000; border:1px solid #bbb; ;background-color: #{{ ch.color }};">{{ ch.name }}</span></a>
        <div><div class="metadata_details">
            <table class="forms">
                {% for field in ch.form %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                {% if ch.form_emission_filter %}
                <tr><th><br/>{% trans "Filter" %}:</th><td colspan="2"></td></tr>
                {% for field in ch.form_emission_filter %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                {% endif %}
                {% if ch.form_detector_settings %}
                <tr><th><br/>{% trans "Detector" %}:</th><td colspan="2"></td></tr>
                {% for field in ch.form_detector_settings %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                {% endif %}
                {% if ch.form_light_source %}
                <tr><th><br/>{% trans "Light source" %}:</th><td colspan="2"></td></tr>
                {% for field in ch.form_light_source %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                {% endif %}
                {% if ch.form_dichroic %}
                <tr><th><br/>{% trans "Dichroic" %}:</th><td colspan="2"></td></tr>
                {% for field in ch.form_dichroic %}
                <tr><td>{{ field.label_tag }}{% if field.field.required %}*{% endif %}</td>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text|safe }}</td>
                </tr>
                {% endfor %}
                {% endif %}
            </table>
        </div></div>
    </li>
    {% endfor %}
</ul>
<br/><p>*{% trans "N/A - this value is not available." %}</p>
</div>
<div class="clear"></div>