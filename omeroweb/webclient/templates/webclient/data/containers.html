{% extends "webclient/base/base_container.html" %}
{% load i18n %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

{% block link %}
    <link rel="stylesheet" href="{% url webstatic "css/container.css" %}" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% url webstatic "css/tree.css" %}" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% url webstatic "css/table.css" %}" type="text/css" media="screen"/>
{% endblock %}

{% block jscript %}

    <script type="text/javascript" src="{% url webstatic "javascript/jquery.simple.tree.js" %}"></script>    
    
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.core.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.draggable.js" %}"></script>

{% endblock %}

{% block script %}
    
    <script type="text/javascript">
        var simpleTreeCollection = null;
        $(document).ready(function() 
            {
                var h = $(window).height()-200;
                $("div#tree_details").css('height', h);
                $("div#metadata_details").css('height', h+31);
                $("div#metadata_details iframe").attr('height', h+31);
                $("div#content_details").css('height', h+31);
                
                $("div#tree_details").html('<p>Loading imported images... please wait <img src="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                $("div#tree_details").load("{% url load_data %}?view=tree", function () {
                    simpleTreeCollection = $('.simpleTree').simpleTree({
                        autoclose: false,
                        afterRootClick:function(node){
                	        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> {% if not nav.experimenter  %}| <input class="button" type="image" src="{% url webstatic "images/window_new16.png" %}" alt="New container" title="New container" onclick="createNewContainer(null);"/>{% endif %}'); 

                            $("#right_panel").hide();
                            $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="expanded-right" id="lhid_trayhandle_icon_right">');
                            $("div#metadata_details").empty();
                            $("div#content_details").removeAttr('rel').children().remove();
                        },
                        afterClick:function(node){
                            if($(node).attr('id') == "orphaned") {                      
                                $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'">'); 
                                $("#right_panel").show();
                                $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">');
                                $("div#metadata_details").html('<p>{% trans "This is virtual container with orphaned images. These images are not linked anywhere. Just drag them to the selected container." %}</p>'); 
                                                           
                                $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                $("div#content_details").load('/webclient/load_data/orphaned/?view=icon');
                                $("div#content_details").attr('rel', 'orphaned');
                            } else {
                                var obj = $(node).attr('id').split("-");
                                var par = $(node).parents('li:first').attr('id')
                                if (obj[0] == 'pr') {
                                    var ro = $(node).children().filter('span').attr('id');
                                    if (ro=='readonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'">');
                                    } else if (ro=='editonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'project\', \''+obj[1]+'\');" />');
                                    } else {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/window_new16.png" %}" alt="New container" title="New container" onclick="createNewContainer('+obj[1]+');"/> <input class="button" type="image" src="{% url webstatic "images/eclipse_paste_edit16.png" %}" alt="Paste" title="Paste" onclick="pasteFromClipboard(\'project\', \''+obj[1]+'\', \'{{ url }}\');" /> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'project\', \''+obj[1]+'\');" />');
                                    }
                                    
                                    $("#right_panel").show();
                                    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">');
                                    $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" src="/webclient/metadata_details/project/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
                                    $('iframe#metadata_details').load();
                                    $("div#content_details").removeAttr('rel').children().remove();
                                } else if (obj[0] == 'ds') {                                     
                                    var ro = $(node).children().filter('span').attr('id');
                                    if (ro=='readonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'">'); 
                                    } else if (ro=='editonly') {
                                        if (par != 0) {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <a href="{% url manage_action_containers "remove" %}dataset/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink dataset?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'dataset\', \''+obj[1]+'\');" title="Delete"/>');
                                        } else {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'dataset\', \''+obj[1]+'\');" title="Delete"/>');
                                        }
                                    } else {
                                        if (par != 0) {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy" title="Copy" onclick="treeCopyToClipboard(\'dataset\', \''+obj[1]+'\');"/> <input id="pasteFromClipboard"  class="button" type="image" src="{% url webstatic "images/eclipse_paste_edit16.png" %}" alt="Paste" title="Paste" onclick="pasteFromClipboard(\'dataset\', \''+obj[1]+'\', \'{{ url }}\');"> <a href="{% url manage_action_containers "remove" %}dataset/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink dataset?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'dataset\', \''+obj[1]+'\');" title="Delete"/>');
                                        } else {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy" title="Copy" onclick="treeCopyToClipboard(\'dataset\', \''+obj[1]+'\');"/> <input id="pasteFromClipboard"  class="button" type="image" src="{% url webstatic "images/eclipse_paste_edit16.png" %}" alt="Paste" title="Paste" onclick="pasteFromClipboard(\'dataset\', \''+obj[1]+'\', \'{{ url }}\');"> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'dataset\', \''+obj[1]+'\');" title="Delete"/>');
                                        }
                                    }
                                    
                                    $("#right_panel").show();
                                    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">');
                                    $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" src="/webclient/metadata_details/dataset/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
                                    $('iframe#metadata_details').load();

                                    if ($("div#content_details").attr('rel') != obj.join("-")) {
                                        if (par != 0) {
                                            var parobj = par.split("-");
                                            $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                            $("div#content_details").load('/webclient/load_data/project/'+parobj[1]+'/dataset/'+obj[1]+'/?view=icon');
                                        } else {
                                            $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                            $("div#content_details").load('/webclient/load_data/dataset/'+obj[1]+'/?view=icon');
                                        }
                                        $("div#content_details").attr('rel', obj.join("-"));
                                    }
                                } else if (obj[0] == 'img') {
                                    var parobj = par.split("-");
                                    var ro = $(node).children().filter('span').attr('id');                                    
                                    if(parobj[0] == "orphaned") {
                                        parobj[1] = "orphaned";
                                        
                                        if (ro=='readonly') {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/>');
                                        } else if (ro=='editonly') {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'image\', \''+obj[1]+'\');" />');
                                        } else {
                                            $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/> <input class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket" title="Add to basket" onclick="toBasket(\'image\', \''+obj[1]+'\');"/> <input class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy" title="Copy" onclick="treeCopyToClipboard(\'image\', \''+obj[1]+'\');" /> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'image\', \''+obj[1]+'\');" />');
                                        }
                                    } else if (ro=='readonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/>');
                                    } else if (ro=='editonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/>  <a href="{% url manage_action_containers "remove" %}image/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink image?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'image\', \''+obj[1]+'\');" />');
                                    } else {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/tree/kview.png" %}" alt="View" title="View" onclick="openPopup(\'/webclient/img_detail/'+obj[1]+'/\');"/> <input class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket" title="Add to basket" onclick="toBasket(\'image\', \''+obj[1]+'\');"/> <input class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy" title="Copy" onclick="treeCopyToClipboard(\'image\', \''+obj[1]+'\');" /> <a href="{% url manage_action_containers "remove" %}image/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink image?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'image\', \''+obj[1]+'\');" />');
                                    }
                                   
                                    
                                    $("#right_panel").show();
                                    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">'); 
                                    $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" src="/webclient/metadata_details/image/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
                                    $('iframe#metadata_details').load();

                                    if ($("div#content_details").attr('rel') != par) {
                                        $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                        if(parobj[0] == "orphaned") {
                                            $("div#content_details").load('/webclient/load_data/orphaned/?view=icon');
                                        } else {
                                            $("div#content_details").load('/webclient/load_data/dataset/'+parobj[1]+'/?view=icon');
                                        }
                                        $("div#content_details").attr('rel', par);
                                    }                                                              
                                } else if (obj[0] == 'sc') {
                                    var ro = $(node).children().filter('span').attr('id');
                                    if (ro=='readonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'">');
                                    } else if (ro=='editonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'screen\', \''+obj[1]+'\');" />');
                                        
                                    } else {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/window_new16.png" %}" onclick="createNewContainer('+obj[1]+');"/> <input class="button" type="image" src="{% url webstatic "images/eclipse_paste_edit16.png" %}" alt="Paste" title="Paste" onclick="pasteFromClipboard(\'screen\', \''+obj[1]+'\', \'{{ url }}\');" /> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'screen\', \''+obj[1]+'\');" />');
                                        
                                    }
                                    
                                    $("#right_panel").show();
                                    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">');
                                    $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" src="/webclient/metadata_details/screen/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
                                    $('iframe#metadata_details').load();
                                    $("div#content_details").removeAttr('rel').children().remove();
                                } else if (obj[0] == 'pl') {
                                    var ro = $(node).children().filter('span').attr('id');
                                    var parobj = par.split("-");
                                    if (ro=='readonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> ');
                                    } else if (ro=='editonly') {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <a href="{% url manage_action_containers "remove" %}image/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink image?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'plate\', \''+obj[1]+'\');" />');

                                    } else {
                                        $("div#buttons").html('<input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href=\'{% url load_template nav.menu %}\'"/> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href=\'{% url load_template "usertags" %}\'"> | <input class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket" title="Add to basket" onclick="toBasket(\'plate\', \''+obj[1]+'\');"/> <input class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy" title="Copy" onclick="treeCopyToClipboard(\'plate\', \''+obj[1]+'\');" /> <a href="{% url manage_action_containers "remove" %}image/'+obj[1]+'/?parent='+par+'&url={{ url }}" alt="Cut" title="Cut" onClick="return confirm(\'Unlink image?\');"><img src="{% url webstatic "images/cut16.png" %}" alt="Cut" title="Cut"/></a> <input class="button" type="image" src="{% url webstatic "images/nuvola_cancel16.png" %}" alt="Delete" title="Delete" onclick="deleteItem(\'plate\', \''+obj[1]+'\');" />');
                                        
                                    }
                                                                        
                                    $("#right_panel").show();
                                    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">'); 
                                    $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" src="/webclient/metadata_details/plate/'+obj[1]+'/" id="metadata_details" name="metadata_details"></iframe>');
                                    $('iframe#metadata_details').load();
                                    
                                    if ($("div#content_details").attr('rel') != obj.join("-")) {
                                        if (par != 0) {
                                            var parobj = par.split("-");
                                            $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                            $("div#content_details").load('/webclient/load_data/screen/'+parobj[1]+'/plate/'+obj[1]+'/?view=icon');
                                        } else {
                                            $("div#content_details").html('<p>Loading data... please wait <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                                            $("div#content_details").load('/webclient/load_data/plate/'+obj[1]+'/?view=icon');
                                        }
                                        $("div#content_details").attr('rel', obj.join("-"));
                                    }
                                }
                            }                
                        },
                        afterDblClick:function(node){                    
                        },
                        afterMove:function(destination, source, pos){
                        },
                        afterAjax:function(){
                        },
                        afterContextMenu:function(node){
                        },
                        animate:true
                        });
                });               
        }) 
        function createNewContainer(pid) {
            if(pid!=null) {
                url = '{% url manage_action_containers "new" %}project/'+pid+'/';
            } else {
                url = '{% url manage_action_containers "new" %}';
            }
            var h = $(window).height()-200;
            
            $("#right_panel").show();
            $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">');
            $("div#metadata_details").html('<iframe width="370" height="'+(h+31)+'" id="metadata_details" src="'+url+'"name="metadata_details"></iframe>');
            $('iframe#metadata_details').load();
            
        }     
        
    </script>
    <script type="text/javascript" src="{% url webstatic "javascript/actions.js" %}"></script>
    
{% endblock %}

{% block left %}

    <div class="toolbar">
        <div id="buttons" class="align_left">
            <input class="button" type="image" src="{% url webstatic "images/reload16.png" %}" alt="Refresh" title="Refresh" onclick="document.location.href='{% url load_template nav.menu %}'"> <input class="button" type="image" src="{% url webstatic "images/view_tag16.png" %}" alt="Tags" title="Tags" onclick="document.location.href='{% url load_template "usertags" %}'"> {% if not nav.experimenter  %}| <input class="button" type="image" src="{% url webstatic "images/window_new16.png" %}" alt="New container" title="New container" onclick="createNewContainer(null);"/> {% endif %}
        </div>
    </div>

<div class="clear"> </div>

<div id="tree_details"> </div>

{% endblock %}

{% block center %}

<div id="content_details"> </div>

{% endblock %}


{% block right %}

<div id="metadata_details">
    <iframe width="370" name="metadata_details"></iframe>
</div>


{% endblock %}



