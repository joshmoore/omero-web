{% load i18n %}
{% load custom_tags %}
{% load wikitags %}

{% if manager.tgannSize %}
<h1>{% trans "Tags" %}:
{% for tag in manager.tag_annotations %}
    <a href="{% url manage_data_by_tag tag.id %}"> {{ tag.textValue }}</a> {% if tag.canWrite %}<a href="{% url manage_action_containers "remove" %}?parent={% if manager.project %}pr-{{ manager.project.id}}{% endif %}{% if manager.dataset %}ds-{{ manager.dataset.id}}{% endif %}{% if manager.image %}img-{{ manager.image.id}}{% endif %}&source=tann-{{ tag.id }}&url={{ url }}" onClick="return confirm('Unlink tag?');"><img src="{% url webstatic "images/cut16.png" %}" alt="u" title="unlink"/></a>{% endif %}, 
{% endfor %}
</h1>
{% endif %}

{% if manager.txannSize %}
<h1>{% trans "Comments" %}:</h1>
    {% for tann in manager.text_annotations %}
    {% if tann.isOwned %}
        <div id="comment_wrapper">
        <div id="comment">
            <div class="head">{{ tann.getOwnerFullName }} {% trans "posted comment at" %} {{ tann.creationEventDate|date:"Y m d H:i:s" }} {% if tann.canWrite %}<a href="{% url manage_action_containers "edit" "comment" tann.id %}?url={{ url }}"><img src="{% url webstatic "images/color_line16.png" %}" alt="e" title="edit"/></a>{% endif %}</div>
            <div class="body">{{ tann.textValue|wikify|safe|linebreaks }}</div>
            <div class="footer"></div>
        </div>
        <div class="photo"><img src="{% url load_photo tann.details.owner.id.val %}" alt="{{ tann.getOwnerFullName }}" title="{{ tann.getOwnerFullName }}" width="40" height="40" /></div>
        </div>
        <div class="clear"></div>
        <br/>
    {% else %}
        <div id="comment_wrapper_rev">
        <div id="comment_rev">
            <div class="head">{{ tann.getOwnerFullName }} {% trans "posted comment at" %} {{ tann.creationEventDate|date:"Y m d H:i:s" }}</div>
            <div class="body">{{ tann.textValue|wikify|safe|linebreaks }}</div>
            <div class="footer"></div>
        </div>
        <div class="photo"><img src="{% url load_photo tann.details.owner.id.val %}" alt="{{ tann.getOwnerFullName }}" title="{{ tann.getOwnerFullName }}" width="40" height="40" /></div>
        </div>
        <div class="clear"></div>
        <br/>
    {% endif %}
    
    {% endfor %}
{% endif %}

{% if manager.urlannSize %}
<h1>{% trans "URLs" %}:</h1>
    <div class="body_url">
    <p>{% for urlann in manager.url_annotations %}
        {{ urlann.textValue|wikify|safe }} {% if urlann.canWrite %}<a href="{% url manage_action_containers "edit" "url" urlann.id %}?url={{ url }}'><img src='{% url webstatic "images/color_line16.png" %}" alt="e" title="edit"/></a> <a href="{% url manage_action_containers "remove" %}?parent={% if manager.project %}pr-{{ manager.project.id}}{% endif %}{% if manager.dataset %}ds-{{ manager.dataset.id}}{% endif %}{% if manager.image %}img-{{ manager.image.id}}{% endif %}&source=uann-{{ urlann.id }}&url={{ url }}" onClick="return confirm('Unlink uri?');"><img src="{% url webstatic "images/cut16.png" %}" alt="u" title="unlink"/></a>{% endif %} ; 
    {% endfor %}</p>
    </div>
{% endif %}

{% if manager.fileannSize %}
<h1>{% trans "Files" %}:</h1>
<ol>
    {% for fileann in manager.file_annotations %}
    <li><a href="{% url manage_annotation "download" fileann.id %}" target="_blank">{{ fileann.getFileName }}</a> {{ fileann.getFileSize|default_if_none:0|filesizeformat }} {% trans "by" %} {{ fileann.getOwnerFullName }} {% trans "at" %} {{ fileann.creationEventDate|date:"Y m d H:i:s" }} {% if fileann.canWrite and not fileann.isOriginalMetadat %}<a href="{% url manage_action_containers "remove" %}?parent={% if manager.project %}pr-{{ manager.project.id}}{% endif %}{% if manager.dataset %}ds-{{ manager.dataset.id}}{% endif %}{% if manager.image %}img-{{ manager.image.id}}{% endif %}&source=fann-{{ fileann.id }}&url={{ url }}" onClick="return confirm('Unlink file?');"><img src="{% url webstatic "images/cut16.png" %}" alt="u" title="unlink"/></a>{% endif %}</li>
    {% endfor %}
</ol>
{% endif %}



