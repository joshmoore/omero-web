{% load i18n %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

<div>
{% if manager.project or manager.dataset %}
    {% if manager.project %}
    <ul class="simpleTree">
    <li class="root" id='0'><span>{{ nav.blitz }}</span>
        <ul>
            <li class="line"> </li>
            <li id="pr-{{ manager.project.id }}" class="folder-close-last-static" style="position: static;">
                <span>{{ manager.project.name }}</span> 
                {% if not manager.project.isOwned %}
                    <img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>
                {% endif %}
            </li>
            <li class="line-last"/>
        </ul>
    </li>
    </ul>

    {% endif %}

    {% if manager.dataset %}
    <ul class="simpleTree">
    <li class="root" id='0'><span>{{ nav.blitz }}</span>
        <ul>
            <li class="line"> </li>
            {% if manager.dataset.copyProjectLinks %}
            {% for c in manager.dataset.copyProjectLinks %}
            <li id="pr-{{ c.parent.id.val }}" class="folder-open-last-static" style="position: static;">
                <span><a href="{% get_webclient_root_url %}/{{ nav.whos }}/project/{{ c.parent.id.val }}/?view={{ nav.view }}">{{ c.parent.name.val }}</a></span> 
                {% if not manager.dataset.isOwned %}
                    <img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>
                {% endif %}
                <ul style="overflow: visible; display: block;">
                    <li class="line"> </li>
                    <li id="ds-{{ manager.dataset.id }}" class="subfolder-close-last-static" style="position: static;">
                        <span>{{ manager.dataset.name }}</span> 
                        {% if not manager.dataset.isOwned %}
                            <img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>
                        {% endif %}
                    </li>
                    <li class="line-last"/>
                </ul>
            </li>
            {% endfor %}
            {% else %}
            <li id="ds-{{ manager.dataset.id }}" class="subfolder-close-last-static" style="position: static;">
                <span>{{ manager.dataset.name }}</span> 
                {% if not manager.dataset.isOwned %}
                    <img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>
                {% endif %}
            </li>
            {% endif %}
            <li class="line-last"/>
        </ul>
    </li>
    </ul>

    {% endif %}
{% else %}
    {% if manager.image %}
    <ul class="simpleTree">
    <li class="root" id='0'><span>{{ nav.blitz }}</span>
        <ul>
            {% if manager.hierarchy.projects or manager.hierarchy.datasets %}
                
                {% for c in manager.hierarchy.projects %}
                <li class="line"> </li>
                {% if c.copyDatasetLinks %}
                <li id="pr-{{ c.id }}" class="folder-open-last-static" style="position: static;">
                    <span><a href="{% get_webclient_root_url %}/{{ nav.whos }}/project/{{ c.id }}/?view={{ nav.view }}">{{ c.name }}</a></span> 
                    {% if not c.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                    <ul style="overflow: visible; display: block;">
                        {% if c.copyDatasetLinks %}
                        {% for d in c.listChildren %}
                        <li class="line"> </li>
                        <li id="ds-{{ d.id }}" class="subfolder-open-last-static" style="position: static;">
                            <span><a href="{% get_webclient_root_url %}/{{ nav.whos }}/project/{{ c.id }}/dataset/{{ d.id }}/?view={{ nav.view }}"> {{ d.name }}</a></span>
                            {% if not d.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                            <ul style="overflow: visible; display: block;">
                                <li class="line"> </li>
                                <li id='img-{{ manager.image.id }}' class="doc-last">
                                    <span>{{ manager.image.shortName }}</span>
                                    {% if not manager.image.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                                </li>
                                <li class="line-last"/>
                            </ul>
                        </li>
                        <li class="line-last"/>
                        {% endfor %}
                        {% endif %}
                    </ul>
                </li>
                {% endif %}
                {% endfor %}

                <li class="line"> </li>
                {% for c in manager.hierarchy.datasets %}
                <li id="ds-{{ c.id }}" class="subfolder-open-last-static" style="position: static;">
                    <span><a href="{% get_webclient_root_url %}/{{ nav.whos }}/dataset/{{ c.id }}/?view={{ nav.view }}">{{ c.name }}</a></span> 
                    {% if not c.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                    <ul style="overflow: visible; display: block;">
                        <li class="line"> </li>
                        <li id='img-{{ manager.image.id }}' class="doc-last">
                            <span>{{ manager.image.shortName }}</span> 
                            {% if not manager.image.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                        </li>
                        <li class="line-last"/>
                    </ul>
                </li>
                {% endfor %}
                <li class="line-last"/>
            {% else %}
                <li class="line"> </li>
                <li id='img-{{ manager.image.id }}' class="doc-last">
                    <span>{{ manager.image.shortName }}</span> 
                    {% if not manager.image.isOwned %}<img src="{% get_webclient_static_url %}/images/tree/kgpg12.gif" alt="locked" title="locked"/>{% endif %}
                </li>
            {% endif %}
            <li class="line-last"/>
        </ul>
    </li>
    </ul>
    {% else %}
        <p>{% trans "Hierarchy structure not available." %}</a>
    {% endif %}
{% endif %}
</div>