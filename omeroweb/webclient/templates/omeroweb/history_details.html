{% load i18n %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

    <script type="text/javascript" src="{% url webstatic "javascript/ui/ui.selectable.js" %}"></script>
    
    <script type="text/javascript">
        $(document).ready(function(){

            $("ul#dataTable").selectable({
            	stop: function(){
            		var result = $("#select-result").empty();
            		var l = $('li.ui-selected img', this).length;
            		$("li.ui-selected input", this).each(function(){
            		    this.checked = true;
            		});
            		if (l == 1) {
            		    $("#right_panel").show();
                        $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">'); 
            		    $('li.ui-selected img', this).each(function(){  
            		        var h = $(window).height()-169;
            		        $("div#metadata_details").html('<iframe width="100%" height="'+h+'" src="/webclient/metadata_details/'+this.alt+'/'+this.id+'/" id="metadata_details" name="metadata_details"></iframe>');
                            $('iframe#metadata_details').load();
                        });
            		} else {
            		    $("#right_panel").show();
            		    $("#swapMeta").html('<img tabindex="0" src="{% url webstatic "images/tree/spacer.gif" %}" class="collapsed-right" id="lhid_trayhandle_icon_right">'); 
            		    $("div#metadata_details").html('<p>'+ l +' elements selected.</p><p><input id="copyToClipboard" class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy to clipboard"> <input id="pasteFromClipboard" class="button" type="image" src="{% url webstatic "images/eclipse_paste_edit16.png" %}" alt="Paste from clipboard" onclick="pasteFromClipboard(\'dataset\', \'{{ manager.dataset.id }}\', \'{{ url }}\'); return false;"> <input id="unlink" class="button" type="image" src="{% url webstatic "images/cut16.png" %}" alt="Unlink" value="ds-{{ manager.dataset.id }}"> | <input id="addToBasket" class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket"> | <a href="{% url load_metadata_details_multi %}" target="metadata_details"><img src="{% url webstatic "images/knotes16.png" %}" alt="a" title="annotation"/></a></p>');
            		}
            	},
            	start: function(){
            		$("li input", this).each(function(){
            			this.checked = false;
            		});
            	}
            });
            
            $("#changeView").click(function() { 
                var rel = $("div#content_details").attr('rel');
                $("div#content_details").html('<p>Loading data... please wait <img src="/webclient/static/images/tree/spinner.gif"/></p>');
                $("div#content_details").load('/webclient/dataset/'+rel+'/?view=icon');
            });
            
        });
    </script>
    
<h1 id="data">{{ eContext.breadcrumb.2 }} {{ eContext.breadcrumb.1 }}</a> {{ controller.total_items_size }} item(s)</h1>

<div>
    {% if controller.day_items_size %}

    <ul id="dataTable">
        {% for i in controller.day_items %}
        {% for c in i.project %}
            <li id="{{ c.id }}"><img id="{{ c.id }}" src="{% url webstatic "images/folder16.png" %}" alt="project" title="{{ c.name }}"/>{{ c.shortName2 }} ({{ c.getDate }}) <input type="checkbox" name="project" id="{{ c.id }}"></li>
        {% endfor %}
        {% for c in i.dataset %}
            <li id="{{ c.id }}"><img id="{{ c.id }}" src="{% url webstatic "images/folder_image16.png" %}" alt="dataset" title="{{ c.name }}"/> {{ c.shortName2 }} ({{ c.getDate }}) <input type="checkbox" name="dataset" id="{{ c.id }}"></li>
        {% endfor %}
        {% for c in i.image %}
            <li id="{{ c.id }}"><img id="{{ c.id }}" src="{% url render_thumbnail_resize 16 c.id  %}" alt="image" title="{{ c.name }}"/> {{ c.shortName2 }} ({{ c.getDate }}) <input type="checkbox" name="image" id="{{ c.id }}"></li>
        {% endfor %}
        {% for c in i.screen %}
            <li id="{{ c.id }}"><img id="{{ c.id }}" src="{% url webstatic "images/folder_screen16.png" %}" alt="screen" title="{{ c.name }}"/> {{ c.shortName2 }} ({{ c.getDate }}) <input type="checkbox" name="screen" id="{{ c.id }}"></li>
        {% endfor %}
        {% for c in i.plate %}
            <li id="{{ c.id }}"><img id="{{ c.id }}" src="{% url webstatic "images/folder_plate16.png" %}" alt="plate" title="{{ c.name }}"/> {{ c.shortName2 }} ({{ c.getDate }}) <input type="checkbox" name="plate" id="{{ c.id }}"></li>
        {% endfor %}
        {% endfor %}
    </ul>

    {% else %}
        {% trans "No data." %}
    {% endif %}
    
    {% include "omeroweb/history_paging.html" %}
    
    <div>
        <p>{% trans "Legend" %}: <img src="{% url webstatic "images/folder16.png" %}" title="Project" alt="project"/> - {% trans "Project" %}; <img src="{% url webstatic "images/folder_image16.png" %}" title="Dataset" alt="dataset"/> - {% trans "Dataset" %}; <img src="{% url webstatic "images/folder_screen16.png" %}" title="Screen" alt="screen"/> - {% trans "Screen" %}; <img src="{% url webstatic "images/folder_plate16.png" %}" title="Plate" alt="plate"/> - {% trans "Plate" %};</p>
    </div>
    
</div>

