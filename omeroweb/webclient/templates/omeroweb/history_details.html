{% extends "omeroweb/base_container.html" %}
{% load i18n %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

{% block link %}
    <link rel="stylesheet" href="{% url webstatic "css/container.css" %}" type="text/css" media="screen"/>
	<link rel="stylesheet" href="{% url webstatic "css/table.css" %}" type="text/css" media="screen"/>
{% endblock %}

{% block jscript %}
    <script type="text/javascript" src="{% url webstatic "javascript/jquery_1.2.6.js" %}"></script>
    
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.tablesorter.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/jquery.quicksearch.js" %}"></script>
{% endblock %}


{% block script %}
    <script type="text/javascript" src="{% url webstatic "javascript/basket.js" %}"></script>
    <script type="text/javascript" src="{% url webstatic "javascript/actions.js" %}"></script>
        
    <script type="text/javascript">
        $(document).ready(function() 
            { 
                $("#dataTable").tablesorter( {sortList: [[1,0]]} ); 
                
                {% if manager.c_size %}
                $('table#dataTable tbody tr').quicksearch({
                    attached: "div#view",
                    position: "before",
                    stripeRowClass: null,
                    labelText: '{% trans "Filter" %}:',
                    inputText: '...',
                    loaderImg: '{% url webstatic "images/tree/spinner.gif" %}',
                });
                {% endif %}
                
                $("a.loadingData").click(function()
                {
                    $("div#hierarchy").html('<p>{% trans "Loading hierarchy... please wait" %} <img src ="{% url webstatic "images/tree/spinner.gif" %}"/></p>');
                    $("div#hierarchy").load(
                        {% if manager.project or manager.dataset or manager.screen or manager.plate %}
                            {% if manager.dataset %}
                                "{% url manage_container_hierarchies_id "dataset" manager.dataset.id %}", 
                            {% endif %}
                            {% if manager.project %}
                                "{% url manage_container_hierarchies_id "project" manager.project.id %}", 
                            {% endif %}
                            {% if manager.plate %}
                                "{% url manage_container_hierarchies_id "plate" manager.plate.id %}", 
                            {% endif %}
                            {% if manager.screen %}
                                "{% url manage_container_hierarchies_id "screen" manager.screen.id %}", 
                            {% endif %}
                        {% else %}
                            "{% url manage_container_hierarchies %}", 
                        {% endif %}
                        function() {  
                            $("a.loadingData").remove();                        
                        });
                    return false; 
                });
        })
    </script>

{% endblock %}

{% block top %}

<h1 id="data"><a href="{% url history_details controller.year controller.month controller.day %}">{{ eContext.breadcrumb.2 }} {{ eContext.breadcrumb.1 }}</a> ({{ controller.day_items_size }}/{{ controller.total_items_size }} {% trans "items" %})</h1>

{% if form_history_type %}
<div id="view"><form action="" method="POST">
    <input type="hidden" name="filter" value="group">
<table>
  <tbody>
    {% for field in form_history_type %}
    <tr><th>{{ field.label_tag }}</th><td class="input">{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}{{ field.help_text }}</td></tr>
    {% endfor %}
  </tbody>
</table>
</form></div>
<div class="clear"> </div>
{% endif %}

{% endblock %}

{% block left %}
<!--content-->
<!--content-->

<div>
    {% if manager.c_size %}
        <h1 id="data">{{ manager.c_size }} {% trans "items" %}:</h1>
    {% else %}
        <h1>{% trans "No items" %}:</h1>
    {% endif %}
    <div class="clear"> </div>
    
    <div id="view"> 
        | <input id="copyToClipboard" class="button" type="image" src="{% url webstatic "images/eclipse_copy_edit16.png" %}" alt="Copy to clipboard"> 
        | <input id="addToBasket" class="button" type="image" src="{% url webstatic "images/basket16.png" %}" alt="Add to basket">
        | <a href="{% url manage_metadata_details_multi %}" target="metadata_details"><img src="{% url webstatic "images/knotes16.png" %}" alt="a" title="annotation"/></a>
    </div>
    <div class="clear"> </div>
    
    <div class="content">
        {% include "omeroweb/history_data_table.html" %}
    </div>
    
    {% include "omeroweb/history_paging.html" %}
    
    <div>
        <p>{% trans "Recognize items" %}: <img src="{% url webstatic "images/folder32.png" %}" title="Project" alt="project"/> - {% trans "Project" %}; <img src="{% url webstatic "images/folder_image32.png" %}" title="Dataset" alt="dataset"/> - {% trans "Dataset" %}; <img src="{% url webstatic "images/image32.png" %}" title="Image" alt="image"/> - {% trans "Image" %};</p>
    </div>
    
</div>

{% endblock %}

{% block right %}

<iframe width="100%" height="680" name="metadata_details"></iframe>

{% endblock %}
