{% extends "omeroweb/base_image_zoom.html" %}
{% load markup %}
{% load custom_tags %}
{% load wikitags %}

{% block link %}
    <link rel="stylesheet" href="{% get_webclient_static_url %}/css/annotation.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% get_webclient_static_url %}/css/googiespell.css" type="text/css" media="screen"/>
{% endblock %}

{% block jscript %}
    <script type="text/javascript" src="{% get_webclient_static_url %}/javascript/jquery_1.2.6.js"></script>
    
    <script type="text/javascript" src="{% get_webclient_static_url %}/javascript/googiespell/AJS.js"></script>
    <script type="text/javascript" src="{% get_webclient_static_url %}/javascript/googiespell/googiespell.js"></script>
    <script type="text/javascript" src="{% get_webclient_static_url %}/javascript/googiespell/cookiesupport.js"></script>
{% endblock %}

{% block script %} 
    <script type="text/javascript" src="{% get_webclient_static_url %}/javascript/blitzcon.js"></script>
    <script>
        $(document).ready(function(){
            $("a.loadAnnotation").click(function()
            {
                $("div#annotation").html('<img src="{% get_webclient_static_url %}/images/tree/spinner.gif"/>');
                $("div#annotation").load("{% get_webclient_root_url %}/annotations/image/{{ image.image.id }}/?url={{ url }}", function() {  
                        $("a.loadAnnotation").remove();                        
                    });
                return false; 
            });
        });
    </script>
{% endblock %}

{% block center %}

<div><center>
    <a href="#" onclick="popup('','_blank','{{ image.image.id }}'); return false;"><img class="imgzoom" src="{% get_webclient_root_url %}/render_thumbnail/big/{{ image.image.id }}/" alt="image" title="{{ image.image.name }}"/></a></center>
    <div><h1>Description: </h1>
        {{ image.image.description|default_if_none:"no description"|wikify|safe|linebreaks }}
    </div>
</div>

<div><a href="#" class="loadAnnotation">Show annotations.</a></div>
<div id="annotation"></div>

<div>
    {% if form_comment %}
    <div>
        <h1>Add new comment:</h1>
        <form action="" method="post"><input type="hidden" name="action" value="comment" />
        <table>
            {% for field in form_comment %}
                <tr>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text }}</td>
                </tr>
            {% endfor %}
                <tr><td colspan="2"><input type="submit" value="Save" /></td></tr>
            </table>
        </form>
        <script type="text/javascript">
            var googie_spell = new GoogieSpell("static_core/googiespell/", "/webclient/spellchecker/?lang=");
            googie_spell.decorateTextarea("id_content", null, "600px");
        </script>
    </div>
    {% endif %}

    {% if form_url %}
    <div>
        <h1>Add new url:</h1>
        <form action="" method="post"><input type="hidden" name="action" value="url" />
        <table>
            {% for field in form_url %}
                <tr>
                    <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text }}</td>
                </tr>
            {% endfor %}
                <tr><td colspan="2"><input type="submit" value="Save" /></td></tr>
            </table>
        </form>
    </div>
    {% endif %}

    {% if form_file %}
    <div>
        <h1>Upload a file</h1>
        <form action="" method="post"><input type="hidden" name="action" value="file" />
        <table>
        {% for field in form_file %}
            <tr>
                <td>{{ field }}</td><td>{% if field.errors %}{{ field.errors }}{% endif %}<br/>{{ field.help_text }}</td>
            </tr>
        {% endfor %}
        </table>
        <input type="submit" value="Upload" />
        </form>
    </div>
    {% endif %}
</div>

{% endblock %}